MAIN = thesis.tex
OBJS = $(MAIN:.tex=.log) $(MAIN:.tex=.aux) $(MAIN:.tex=.out) $(MAIN:.tex=.toc) $(MAIN:.tex=.synctex.gz) $(MAIN:.tex=.bbl) $(MAIN:.tex=.blg)

thesis: $(MAIN:.tex=.pdf)

$(MAIN:.tex=.pdf): $(MAIN:.tex=.bib) $(glob *.tex)

.tex.pdf:
	pdflatex.exe $(<:.bib=.tex)
	bibtex.exe $(<:.tex=)
	pdflatex.exe $<
	pdflatex.exe -synctex=1 $<

fixup:
	-xse -x\0 s/\b(\w\.)(\w\.)(?=\s)/\1\\,\2/g *.tex
	-xse -x\0 s/etc\.(?!\})/\\emph{etc.}/g *.tex

clean:
	del $(OBJS)
